// Compiled by ClojureScript 0.0-2341
goog.provide('yuggoth.pages.profile');
goog.require('cljs.core');
goog.require('reagent.core');
goog.require('yuggoth.util');
goog.require('yuggoth.util');
goog.require('yuggoth.session');
goog.require('yuggoth.session');
goog.require('reagent.core');
goog.require('reagent.core');
yuggoth.pages.profile.update_password_BANG_ = (function update_password_BANG_(pass){var old_pass = new cljs.core.Keyword(null,"old-pass","old-pass",772159130).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass));var new_pass = new cljs.core.Keyword(null,"new-pass","new-pass",1659859390).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass));var repeat_pass = new cljs.core.Keyword(null,"repeat-pass","repeat-pass",-1718103543).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass));return yuggoth.util.POST.call(null,"/change-admin-password",new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"headers","headers",-835030129),new cljs.core.PersistentArrayMap(null, 1, ["Authorization",yuggoth.util.auth_hash.call(null,yuggoth.session.get_in.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"profile","profile",-545963874),new cljs.core.Keyword(null,"handle","handle",1538948854)], null)),old_pass)], null),new cljs.core.Keyword(null,"params","params",710516235),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"pass","pass",1574159993),new_pass,new cljs.core.Keyword(null,"repeat-pass","repeat-pass",-1718103543),repeat_pass], null),new cljs.core.Keyword(null,"handler","handler",-195596612),((function (old_pass,new_pass,repeat_pass){
return (function (_){return cljs.core.reset_BANG_.call(null,pass,cljs.core.PersistentArrayMap.EMPTY);
});})(old_pass,new_pass,repeat_pass))
,new cljs.core.Keyword(null,"error-handler","error-handler",-484945776),((function (old_pass,new_pass,repeat_pass){
return (function (response){return cljs.core.swap_BANG_.call(null,pass,cljs.core.assoc,new cljs.core.Keyword(null,"error","error",-978969032),cljs.core.get_in.call(null,response,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"response","response",-1068424192),new cljs.core.Keyword(null,"error","error",-978969032)], null)));
});})(old_pass,new_pass,repeat_pass))
], null));
});
yuggoth.pages.profile.save_BANG_ = (function save_BANG_(uri,id,field){return (function (){var value = cljs.core.deref.call(null,field);return yuggoth.util.POST.call(null,uri,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"params","params",710516235),new cljs.core.PersistentArrayMap.fromArray([id,value], true, false),new cljs.core.Keyword(null,"handler","handler",-195596612),((function (value){
return (function (p__5725){var vec__5726 = p__5725;var status = cljs.core.nth.call(null,vec__5726,(0),null);if(cljs.core._EQ_.call(null,(1),status))
{return yuggoth.session.assoc_in_BANG_.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"profile","profile",-545963874),id], null),value);
} else
{return null;
}
});})(value))
], null));
});
});
yuggoth.pages.profile.input_field = (function input_field(element,uri,id,field){return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),element,((cljs.core.not_EQ_.call(null,cljs.core.deref.call(null,field),yuggoth.session.get_in.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"profile","profile",-545963874),id], null))))?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.button","span.button",-541834575),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-click","on-click",1632826543),yuggoth.pages.profile.save_BANG_.call(null,uri,id,field)], null),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"save","save",1850079149))], null):null)], null);
});
yuggoth.pages.profile.blog_title = (function blog_title(title){return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"blog-title","blog-title",560821880))], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.input_field,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.util.text_input,title], null),"/set-blog-title",new cljs.core.Keyword(null,"title","title",636505583),title], null)], null);
});
yuggoth.pages.profile.admin_handle = (function admin_handle(handle){return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"user","user",1532431356))], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.input_field,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.util.text_input,handle], null),"/set-admin-handle",new cljs.core.Keyword(null,"handle","handle",1538948854),handle], null)], null);
});
yuggoth.pages.profile.admin_email = (function admin_email(email){return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"email","email",1415816706))], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.input_field,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.util.text_input,email], null),"/set-admin-email",new cljs.core.Keyword(null,"email","email",1415816706),email], null)], null);
});
yuggoth.pages.profile.admin_details = (function admin_details(about){return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"about-title","about-title",-2136666028))], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.input_field,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"textarea.edit-post-text","textarea.edit-post-text",-900838054),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"value","value",305978217),cljs.core.deref.call(null,about),new cljs.core.Keyword(null,"on-change","on-change",-732046149),(function (p1__5727_SHARP_){return cljs.core.reset_BANG_.call(null,about,yuggoth.util.input_value.call(null,p1__5727_SHARP_));
})], null)], null),"/set-admin-details",new cljs.core.Keyword(null,"about","about",1423892543),about], null)], null);
});
yuggoth.pages.profile.change_password = (function change_password(){var pass = reagent.core.atom.call(null,cljs.core.PersistentArrayMap.EMPTY);return ((function (pass){
return (function (){return new cljs.core.PersistentVector(null, 11, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"password","password",417022471))], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"input","input",556931961),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"type","type",1174270348),"password",new cljs.core.Keyword(null,"placeholder","placeholder",-104873083),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"password","password",417022471)),new cljs.core.Keyword(null,"value","value",305978217),new cljs.core.Keyword(null,"old-pass","old-pass",772159130).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass)),new cljs.core.Keyword(null,"on-change","on-change",-732046149),((function (pass){
return (function (p1__5728_SHARP_){return cljs.core.swap_BANG_.call(null,pass,cljs.core.assoc,new cljs.core.Keyword(null,"old-pass","old-pass",772159130),yuggoth.util.input_value.call(null,p1__5728_SHARP_));
});})(pass))
], null)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"br","br",934104792)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"input","input",556931961),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"type","type",1174270348),"password",new cljs.core.Keyword(null,"placeholder","placeholder",-104873083),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"new-password","new-password",-1530942754)),new cljs.core.Keyword(null,"value","value",305978217),new cljs.core.Keyword(null,"new-pass","new-pass",1659859390).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass)),new cljs.core.Keyword(null,"on-change","on-change",-732046149),((function (pass){
return (function (p1__5729_SHARP_){return cljs.core.swap_BANG_.call(null,pass,cljs.core.assoc,new cljs.core.Keyword(null,"new-pass","new-pass",1659859390),yuggoth.util.input_value.call(null,p1__5729_SHARP_));
});})(pass))
], null)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"br","br",934104792)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"input","input",556931961),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"type","type",1174270348),"password",new cljs.core.Keyword(null,"placeholder","placeholder",-104873083),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"confirm-password","confirm-password",1576165176)),new cljs.core.Keyword(null,"value","value",305978217),new cljs.core.Keyword(null,"repeat-pass","repeat-pass",-1718103543).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass)),new cljs.core.Keyword(null,"on-change","on-change",-732046149),((function (pass){
return (function (p1__5730_SHARP_){return cljs.core.swap_BANG_.call(null,pass,cljs.core.assoc,new cljs.core.Keyword(null,"repeat-pass","repeat-pass",-1718103543),yuggoth.util.input_value.call(null,p1__5730_SHARP_));
});})(pass))
], null)], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"br","br",934104792)], null),(function (){var temp__4126__auto__ = new cljs.core.Keyword(null,"info","info",-317069002).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass));if(cljs.core.truth_(temp__4126__auto__))
{var info = temp__4126__auto__;return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),info], null);
} else
{return null;
}
})(),(function (){var temp__4126__auto__ = new cljs.core.Keyword(null,"error","error",-978969032).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass));if(cljs.core.truth_(temp__4126__auto__))
{var error = temp__4126__auto__;return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.error","div.error",314336058),error], null);
} else
{return null;
}
})(),((cljs.core.not_EQ_.call(null,new cljs.core.Keyword(null,"new-pass","new-pass",1659859390).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass)),new cljs.core.Keyword(null,"repeat-pass","repeat-pass",-1718103543).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass))))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.error","div.error",314336058),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"pass-mismatch","pass-mismatch",1706975363))], null):(cljs.core.truth_(cljs.core.not_empty.call(null,new cljs.core.Keyword(null,"new-pass","new-pass",1659859390).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,pass))))?new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"span.button","span.button",-541834575),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"on-click","on-click",1632826543),((function (pass){
return (function (){return yuggoth.pages.profile.update_password_BANG_.call(null,pass);
});})(pass))
], null),"change password"], null):null))], null);
});
;})(pass))
});
yuggoth.pages.profile.profile_page = (function profile_page(){var title = reagent.core.atom.call(null,yuggoth.session.get_in.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"profile","profile",-545963874),new cljs.core.Keyword(null,"title","title",636505583)], null)));var handle = reagent.core.atom.call(null,yuggoth.session.get_in.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"profile","profile",-545963874),new cljs.core.Keyword(null,"handle","handle",1538948854)], null)));var email = reagent.core.atom.call(null,yuggoth.session.get_in.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"profile","profile",-545963874),new cljs.core.Keyword(null,"email","email",1415816706)], null)));var about = reagent.core.atom.call(null,yuggoth.session.get_in.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"profile","profile",-545963874),new cljs.core.Keyword(null,"about","about",1423892543)], null)));return ((function (title,handle,email,about){
return (function (){return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.contents","div.contents",-1428662400),new cljs.core.PersistentVector(null, 6, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.edit-admin","div.edit-admin",-508752531),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.blog_title,title], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.admin_handle,handle], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.admin_email,email], null),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.change_password], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [yuggoth.pages.profile.admin_details,about], null)], null),new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.admin-preview","div.admin-preview",1832279008),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div.entry-title","div.entry-title",1921453503),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),cljs.core.deref.call(null,title)], null)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h3","h3",2067611163),cljs.core.deref.call(null,handle)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h3","h3",2067611163),cljs.core.deref.call(null,email)], null),new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"h2","h2",-372662728),yuggoth.util.text.call(null,new cljs.core.Keyword(null,"about","about",1423892543))], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"div","div",1057191632),yuggoth.util.markdown.call(null,cljs.core.deref.call(null,about))], null)], null)], null)], null);
});
;})(title,handle,email,about))
});

//# sourceMappingURL=profile.js.map